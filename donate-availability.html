<!DOCTYPE html>
<html lang="en">

<head>
	<meta charset="utf-8" />
	<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
	<meta name="description" content="" />
	<meta name="author" content="" />
	<title>FoodFerry - Donate</title>
	<!-- Favicon-->
	<link rel="icon" type="image/x-icon" href="assets/favicon.ico" />
	<!-- Bootstrap and Bootstrap icons-->
	<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.1.3/dist/css/bootstrap.min.css" rel="stylesheet"
		integrity="sha384-1BmE4kWBq78iYhFldvKuhfTAU6auU8tT94WrHftjDbrCEXSU1oBoqyl2QvZ6jIW3" crossorigin="anonymous">
	<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet" />
	<!-- Font Awesome -->
	<script src="https://kit.fontawesome.com/f20ebef500.js" crossorigin="anonymous"></script>
	<!-- Core theme CSS (includes Bootstrap)-->
	<link href="css/donate.css" rel="stylesheet" />
	<link href="css/home-nav.css" rel="stylesheet" />

	<!-- full calendar -->
	<link rel="stylesheet" href="fullcalendar/main.css" />
	<script src="fullcalendar/main.js"></script>

</head>


<!-- Responsive navbar and header-->
<header>
	<nav class="navbar navbar-expand-md navbar-dark fixed-top">
		<div class="container-fluid">
			<a class="navbar-brand px-3 fw-bolder fs-2" href="./index.html" style="color:#7ED7D3">FoodFerry</a>
			<button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
				aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation">
				<span class="navbar-toggler-icon"></span>
			</button>
			<div class="collapse navbar-collapse fs-5 fw-bold px-3" id="navbarCollapse">
				<ul class="navbar-nav me-auto mb-2 mb-md-0">
					<li class="nav-item">
						<a class="nav-link" aria-current="page" href="./dashboard.html">Dashboard</a>
					</li>
					<li class="nav-item">
						<a class="nav-link active" href="donate-details.html">Donate</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="history.html">History</a>
					</li>
					<li class="nav-item">
						<a class="nav-link" href="./partners.html">Our Partners</a>
					</li>
					<!-- <li>
						<input type="text" class="form-control mx-3" placeholder="Search">
					</li> -->
				</ul>

				<ul class="navbar-nav mb-2 mb-md-0">

					<!-- Notifications-->
					<li>
						<!-- Notifications button -->
						<button id="notifDropdownBtn" class="btn dropdown-toggle navIcon" type="button"
							data-bs-toggle="dropdown" aria-expanded="false">
							<i class="bi bi-bell-fill fs-4"></i>
						</button>

						<!-- Notification dropdown -->
						<ul class="dropdown-menu" id="notifDropdownList">
							<li><a href="./dashboard.html" id="navDropdownItemEmpty">
									<div class="mb-0 mx-3 my-0 text-left text-muted">
										You have no new notifications.
									</div>
								</a></li>


						</ul>
					</li>

					<!-- User settings -->
					<li>
						<!-- User button-->
						<button id="userDropdownBtn" class="btn dropdown-toggle navIcon" type="button"
							data-bs-toggle="dropdown" aria-expanded="false">
							<i class="bi bi-person-fill fs-4"></i>
						</button>

						<!-- User dropdown -->
						<ul class="dropdown-menu" id="userDropdownList">
							<li class="navDropdownListItem"><a href="./profile.html" class="navDropdownItem">
									User Profile</a></li>
							<li class="navDropdownListItem"><a href="./settings.html" class="navDropdownItem">
									Settings</a></li>
							<li>
								<hr class="dropdown-divider">
							</li>
							<li class="navDropdownListItem"><a href="./index.html" class="navDropdownItem">
									Log Out</a></li>
						</ul>
					</li>

				</ul>
			</div>
		</div>
	</nav>

</header>

<body>

	<div class="container-md mt-5">
		<div class="row ">
			<!-- Form page 1 food category selection -->

			<div class="col-sm-12 text-center p-0 mt-3 mb-2">
				<div class="card px-0 pt-4 pb-0 my-3">
					<!-- Form Title [remain constant] -->
					<h2 class="mb-4 fs-1"><strong>Donate Food Waste</strong></h2>
					<div class="row">
						<div class="col-md-12">

							<!-- Progress Bar -->
							<ul id="progressbar" class='p-0'>
								<li class="active" id="food-details">
									<strong>Donation Details</strong>
								</li>
								<li class="active" id="pick-up">
									<strong>Pick Up</strong>
								</li>
								<li class="active" id="type">
									<strong>Donation Type</strong>
								</li>
								<li class="active" id="availability">
									<strong>Availability</strong>
								</li>
								<li id="confirmation">
									<strong>Confirmation</strong>
								</li>
							</ul>

							<!-- Pick Up Availability -->
							<fieldset class="step step3">
								<div class="row mx-2 mb-3 justify-content-center">
									<div class="col-lg-5">
										<div class="card mb-3">
											<h1 class="card-header fs-3">
												<strong>Availability Form</strong>
											</h1>
											<div class="card-header">
												<ul class="nav nav-tabs card-header-tabs" id="myTab" role="tablist">
													<li class="nav-item">
														<a class="nav-link active" id="singledate-tab"
															data-bs-toggle="tab" data-bs-target="#singledate"
															type="button" role="tab" aria-controls="singledate"
															aria-selected="true">Single Day</a>
													</li>
													<li class="nav-item">
														<a class="nav-link" id="multidate-tab" data-bs-toggle="tab"
															data-bs-target="#multidate" type="button" role="tab"
															aria-controls="multidate" aria-selected="false">Multiple
															Days</a>
													</li>
												</ul>
											</div>
											<div class="card-body tab-content" id="myTabContent">
												<div class="tab-pane fade show active" id="singledate" role="tabpanel"
													aria-labelledby="singledate-tab">
													<form id="single-date-form" class="row row-cols-2 needs-validation"
														novalidate>
														<div id="date-specific" class="col-12">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpDate" type="date"
																	required />
																<label for="pickUpDate">Pick Up Date</label>
																<div class="invalid-feedback">
																	Pick up date is required.
																</div>
															</div>

														</div>
														<div id="av-time-from" class="col-6">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpTimeFrom"
																	type="time" placeholder="Date" required />
																<label for="pickUpTimeFrom">Available Time
																	From</label>
																<div class="invalid-feedback">
																	Time is required.
																</div>
															</div>
														</div>
														<div id="av-time-to" class="col-6">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpTimeTo"
																	type="time" placeholder="Date" required />
																<label for="pickUpTimeTo">Available Time
																	To</label>
																<div class="invalid-feedback">
																	Time is required.
																</div>
															</div>
														</div>
														<div id="remarks" class="col-12">
															<div class="form-floating mb-3">
																<textarea class="form-control" id="remark" type="text"
																	placeholder="Enter your message here..."
																	style="height: 10rem"></textarea>
																<label for="remark">Remarks (optional)</label>
																<div class="invalid-feedback">A message is
																	required.
																</div>
															</div>
														</div>
														<div class="col-12 d-grid">
															<button type="submit" id='add-availability-single'
																class="btn btn-success">Add
																Availability</button>
														</div>
													</form>
												</div>


												<div class="tab-pane fade" id="multidate" role="tabpanel"
													aria-labelledby="multidate-tab">

													<form id="multi-date-form" class="row row-cols-2 needs-validation"
														novalidate>
														<div id="date-from" class="col-lg-6">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpDateFromMulti"
																	type="date" placeholder="dd/mm/yyyy"
																	data-date-format="dd-mm-yyyy" required />
																<label for="pickUpDateFromMulti">Pick Up Date From
																</label>
																<div class="invalid-feedback">
																	Pick up date is required.
																</div>
															</div>
														</div>
														<div id="date-to" class="col-lg-6">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpDateToMulti"
																	type="date" placeholder="dd/mm/yyyy"
																	data-date-format="dd-mm-yyyy" required />
																<label for="pickUpDateToMulti">Pick Up Date To
																</label>
																<div class="invalid-feedback">
																	Pick up date is required.
																</div>
															</div>
														</div>
														<div id="av-time-from" class="col-lg-6">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpTimeFromMulti"
																	type="time" placeholder="Date" required />
																<label for="pickUpTimeFromMulti">
																	Available Time From
																</label>
																<div class="invalid-feedback">
																	Time is required.
																</div>
															</div>
														</div>
														<div id="av-time-to" class="col-lg-6">
															<div class="form-floating mb-3">
																<input class="form-control" id="pickUpTimeToMulti"
																	type="time" placeholder="Date" required />
																<label for="pickUpTimeToMulti">
																	Available Time To
																</label>
																<div class="invalid-feedback">
																	Time is required.
																</div>
															</div>
														</div>
														<div class="col-12">
															<div class="form-floating mb-3">
																<textarea class="form-control" id="remarkMulti" type="text"
																	placeholder="Enter your message here..."
																	style="height: 10rem"></textarea>
																<label for="remarkMulti">Remarks (optional)</label>
																<div class="invalid-feedback">
																	A message is required.
																</div>
															</div>
														</div>
														<div class="col-12 d-grid">
															<button type="submit" id='add-availability-multi'
																class="btn btn-success">
																Add Availability
															</button>
														</div>
													</form>


												</div>

											</div>
										</div>
									</div>
									<div class="col-lg-7">
										<div class="card mb-3">
											<h1 class="card-header fs-3">
												<strong>Calendar Overview</strong>
												<span class="mx-2 fs-6">
													<i class="bi bi-info-circle-fill text-primary"
														data-bs-toggle="tooltip" data-bs-placement="top"
														title="Calendar overview shows your current schedule and availability based on your listing activities">
													</i>
												</span>
											</h1>
											<div class="card-body">
												<div id='calendar'>
												</div>
											</div>

										</div>
									</div>
								</div>


								<!-- buttons -->
								<div class="row mx-2 mb-4 justify-content-center">
									<div class="col-lg-6 col-sm-12 d-grid mb-2">
										<button onclick="prevBtn()" type="button"
											class="btn btn-light btn-lg prev-btn border-success">
											Previous
										</button>
									</div>
									<div class="col-lg-6 col-sm-12 d-grid mb-2">
										<button type="button" class="btn btn-success btn-lg next-btn" id="next-btn"
											onclick="nextBtn()" disabled>
											Next
										</button>
									</div>
								</div>
							</fieldset>



						</div>
					</div>
				</div>
			</div>
		</div>
	</div>

	

	<!-- loop 11 -->
	<script src="//cdn.loop11.com/embed.js" type="text/javascript" async="async"></script>

	<!-- Bootstrap and Propper core JS-->
	<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.2/dist/js/bootstrap.bundle.min.js"
		integrity="sha384-kQtW33rZJAHjgefvhyyzcGF3C5TFyBQBA13V1RKPf4uH+bwyzQxZ6CmMZHmNBEfJ" crossorigin="anonymous">
	</script>

	<!-- Popovers and core theme [MUST INCLUDE FOR POPOVERS/TOOLTIPS] -->
	<script src="js/scripts.js"></script>

</body>






<script>
	
	var calendarEl = document.getElementById('calendar');
	var calendar = new FullCalendar.Calendar(calendarEl, {
		schedulerLicenseKey: 'GPL-My-Project-Is-Open-Source',
		initialView: 'dayGridMonth',
		selectable: true,
		themeSystem: 'standard',
		showNonCurrentDates: false,
		contentHeight: 450,
		events: [{
			title: 'orange donation, 5kg',
			start: '2021-10-04',
			end: '2021-10-07',
			display: 'block',
			color: 'red'
		}],
		dateClick: function (info) {
			alert('Clicked on: ' + info.dateStr);
			// change the day's background color just for fun
			// info.dayEl.style.backgroundColor = 'red';
		}

	});
	calendar.render();

	

	//get contact details from session
	console.log(sessionStorage.getItem('pickUpDetails'));

	//Previous button
	function prevBtn() {
		window.location.href = "donate-type.html"
	}

	function nextBtn() {
		window.location.href = "donate-confirmation.html"
	}

	// error checking for date
	var sdValid = false;
	var mdValid = false;

	const singleDateForm = document.querySelector("#single-date-form");
	singleDateForm.addEventListener("submit", function (event) {
		console.log("event is fired")
		event.preventDefault();
		if (!singleDateForm.checkValidity()) {
			console.log("form is invalid")
			event.stopPropagation();
		} else {
			// check for further validity
			var valid = true;
			var errMsg = [];
			var pickUpDate = document.getElementById("pickUpDate").value;
			var pickUpTimeFrom = document.getElementById("pickUpTimeFrom").value;
			var pickUpTimeTo = document.getElementById("pickUpTimeTo").value;

			if (pickUpDate != "2021-11-26") {
				valid = false;
				errMsg.push("Pick up date should be 26 Nov 2021 (single day)");
			}

			if (pickUpTimeFrom != "09:00") {
				valid = false;
				errMsg.push("Pick up time (from) should be 09:00 AM (single day)")
			}

			if (pickUpTimeTo != "12:00") {
				valid = false;
				errMsg.push("Pick up time (to) should be 12:00 PM (single day)")
			}


			if (valid) {
				console.log("all input is valid")
				singleDateForm.reset();
				// document.querySelector("#next-btn").disabled = false
				dateStr = new Date(pickUpDate);
				calendar.addEvent({
					title: 'Orange Peels',
					start: pickUpDate,
					allDay: true
				})
				alert("Availability has been added to calendar! \r\n Date: " + pickUpDate + "\r\n Time: " + pickUpTimeFrom + " to " + pickUpTimeTo)
				sdValid = true;
				if (sdValid && mdValid){
					document.querySelector("#next-btn").disabled = false;
				}
			} else {
				alert(errMsg.join('\r\n'))
				console.log("input is still invalid")
				event.stopPropagation();
			}

		}
	})

	const multiDateForm = document.querySelector("#multi-date-form");
	multiDateForm.addEventListener("submit", function (event) {
		event.preventDefault();
		if (!multiDateForm.checkValidity()) {
			console.log("form is invalid")
			event.stopPropagation();
		} else {
			// check for further validity
			var valid = true;
			var errMsg = [];
			var pickUpDateFrom = document.getElementById("pickUpDateFromMulti").value;
			var pickUpDateTo = document.getElementById("pickUpDateToMulti").value;
			var pickUpTimeFrom = document.getElementById("pickUpTimeFromMulti").value;
			var pickUpTimeTo = document.getElementById("pickUpTimeToMulti").value;

			if (pickUpDateFrom != "2021-11-22") {
				valid = false;
				errMsg.push("Pick up date from should be 22 Nov 2021 (multiple days)")
			}

			if (pickUpDateTo != "2021-11-25") {
				valid = false;
				errMsg.push("Pick up date from should be 25 Nov 2021 (multiple days)")
			}

			if (pickUpTimeFrom != "15:00") {
				valid = false;
				errMsg.push("Pick up time (from) should be 3:00 PM (multiple days)")
			}

			if (pickUpTimeTo != "17:00") {
				valid = false;
				errMsg.push("Pick up time (to) should be 17:00 PM  (multiple days)")
			}


			if (valid) {
				console.log("all input is valid")
				singleDateForm.reset();
				// document.querySelector("#next-btn").disabled = false
				dateStr = new Date(pickUpDate);
				calendar.addEvent({
					title: 'Orange Peels',
					start: pickUpDateFrom,
					end: pickUpDateTo,
					allDay: true,
				})
				alert("Availability has been added to calendar! \r\n Date: " + pickUpDateFrom + " to " + pickUpDateTo + "\r\n Time: " + pickUpTimeFrom + " to " + pickUpTimeTo)
				mdValid = true;

				if (sdValid && mdValid){
					document.querySelector("#next-btn").disabled = false;
				}

			} else {
				alert(errMsg.join('\r\n'))
				console.log("input is still invalid")
				event.stopPropagation();
			}

		}
	})



</script>



</html>